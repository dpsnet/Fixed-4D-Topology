# P-adic数学习笔记

## 个人学习记录

**日期**: 2026-02-11  
**主题**: p-adic数基础计算与性质  
**目标**: 为p-adic模形式学习打基础

---

## 1. 初次接触p-adic数的感受

### 1.1 直观理解

p-adic数是一种"从右往左"展开的数系，与实数的"从左往右"（小数展开）形成鲜明对比。

**实数视角**:
```
π = 3.1415926...  (无限向右展开)
```

**p-adic视角** (以5-adic为例):
```
...312 (在 ℤ₅ 中代表某个数)
```

这种展开方式反映了p-adic拓扑的特性：**小数部分"确定"，大数部分"模糊"**。

### 1.2 心理适应过程

| 阶段 | 感受 | 突破点 |
|-----|------|--------|
| 初识 | 完全反直觉 | 理解赋值的定义 |
| 计算 | 老想验证 | 用Hensel引理解方程 |
| 理解 | 开始习惯 | 接受强三角不等式 |
| 深入 | 发现美感 | 认识到拓扑性质 |

---

## 2. 核心概念理解

### 2.1 p-adic赋值 v_p(x)

**我的理解**: $v_p(x)$ 告诉你 $x$ 被 $p$ 整除多少次。

**关键洞察**:
- $v_p(x) > 0$: $x$ 被 $p$ 整除（"小"）
- $v_p(x) = 0$: $x$ 不被 $p$ 整除（单位）
- $v_p(x) < 0$: $x$ 的分母被 $p$ 整除（"大"）

**例子**:
```
v₅(125) = v₅(5³) = 3     (很小)
v₅(1) = 0                (单位)
v₅(1/5) = -1             (很大)
```

### 2.2 p-adic绝对值 |x|_p

**公式**: $|x|_p = p^{-v_p(x)}$

**直观**: 
- 被 $p$ 整除越多次 → $v_p$ 越大 → $|x|_p$ 越小 → 越"接近"0
- 这与通常的绝对值完全相反！

**比喻**: 
想象 $p$ 是一个"黑洞"，被它吸入（整除）越多，在p-adic视野中就越"消失"。

### 2.3 强三角不等式

**公式**: $|x + y|_p \leq \max(|x|_p, |y|_p)$

**我的理解**: 
在p-adic世界中，"两个相近的数相加不会走太远"。

**几何意义**:
- 所有p-adic三角形都是"等腰或退化"的
- 没有细长的三角形

**验证实例**:
在 ℚ₅ 中:
- $|5|_5 = 1/5$, $|3|_5 = 1$
- $|5 + 3|_5 = |8|_5 = 1 = \max(1/5, 1)$ ✓
- $|5 + 20|_5 = |25|_5 = 1/25 < \max(1/5, 1/25) = 1/5$ （严格不等式）

---

## 3. 计算实践心得

### 3.1 创建p-adic数的方法

```python
import padic

# 方法1: 从整数创建
a = padic.Padic.from_int(100, p=5, N=20)

# 方法2: 从分数创建  
b = padic.Padic.from_frac(1, 3, p=5, N=20)

# 方法3: 直接构造 (精度, 赋值, 单位部分, 素数)
c = padic.Padic(20, 2, 3, 5)  # 5² × 3
```

**选择建议**:
- 整数 → 方法1
- 有理数 → 方法2
- 已知展开 → 方法3

### 3.2 展开式计算技巧

手动计算 $\frac{1}{2}$ 在 ℤ₅ 中的展开:

**步骤**:
1. 解 $2x \equiv 1 \pmod{5}$ → $x \equiv 3 \pmod{5}$
2. 设 $x = 3 + 5a_1$，代入 $2x \equiv 1 \pmod{25}$
3. $6 + 10a_1 \equiv 1 \pmod{25}$
4. $10a_1 \equiv -5 \equiv 20 \pmod{25}$
5. $2a_1 \equiv 4 \pmod{5}$ → $a_1 = 2$
6. 继续...

**结果**: $\frac{1}{2} = 3 + 2\cdot 5 + 2\cdot 5^2 + 2\cdot 5^3 + \cdots$

**验证**: $2 \times (3 + 2\cdot 5 + 2\cdot 5^2 + \cdots) = 6 + 4\cdot 5 + 4\cdot 5^2 + \cdots$

$= 1 + 5 + 4\cdot 5 + 4\cdot 5^2 + \cdots = 1 + 5(1 + 4 + 4\cdot 5 + \cdots)$

注意到 $1 + 4 = 5$，所以确实等于1。

### 3.3 Hensel引理应用

**核心思想**: 从模 $p$ 的解提升到 $p$-adic解。

**我的理解流程图**:
```
模p有解? ──否──→ 无p-adic解
    │
   是
    ↓
f'(x₀)≢0 (mod p)? ──否──→ 需要更精细分析
    │
   是
    ↓
存在唯一的p-adic解!
```

**实战检验**:

| 问题 | 模p检验 | 结果 |
|-----|--------|-----|
| √2 in ℚ₇ | 3² ≡ 2 (mod 7) | ✓ 存在 |
| √(-1) in ℚ₅ | 2² ≡ -1 (mod 5) | ✓ 存在 |
| √2 in ℚ₃ | 无解 | ✗ 不存在 |
| √3 in ℚ₇ | 无解 | ✗ 不存在 |

---

## 4. 级数展开的收敛性

### 4.1 收敛半径表

| 级数 | 收敛条件 | p=2 | p=3 | p=5 | p=7 |
|-----|---------|-----|-----|-----|-----|
| exp(x) | $\|x\|_p < p^{-1/(p-1)}$ | $\|x\|_2 < 0.5$ | $\|x\|_3 < 0.58$ | $\|x\|_5 < 0.67$ | $\|x\|_7 < 0.73$ |
| log(1+x) | $\|x\|_p < 1$ | $\|x\|_2 < 1$ | $\|x\|_3 < 1$ | $\|x\|_5 < 1$ | $\|x\|_7 < 1$ |
| sin(x), cos(x) | 同exp | 同exp | 同exp | 同exp | 同exp |

### 4.2 收敛性差异的原因

**为什么exp的收敛域这么小？**

exp级数中的 $n!$ 分母含有越来越多的 $p$ 因子。
当 $|x|_p$ 不够小时，$x^n/n!$ 的绝对值不会趋于0。

**具体计算**:
在 ℚ₅ 中，考虑 $v_5(n!)$:
$$v_5(n!) = \lfloor n/5 \rfloor + \lfloor n/25 \rfloor + \cdots$$

对于 $x = 5$ ($v_5(x) = 1$):
$$v_5\left(\frac{x^n}{n!}\right) = n - v_5(n!)$$

需要 $n - v_5(n!) \to \infty$ 才能收敛。

### 4.3 实用建议

- exp: 只对非常"小"的数使用（$|x|_p < 1/p$）
- log: 对 $x \equiv 1 \pmod{p}$ 使用
- sin/cos: 同exp，实际中很少使用

---

## 5. 拓扑性质的理解

### 5.1 完全不连通

**实数**中，区间 $[0,1]$ 是连通的。

**p-adic**中，$\mathbb{Z}_p$ 是完全不连通的——它可以写成开闭集的并：
$$\mathbb{Z}_p = \bigsqcup_{a=0}^{p-1} (a + p\mathbb{Z}_p)$$

**我的理解**: p-adic空间像"康托集"一样，充满了"洞"。

### 5.2 p-adic球的神奇性质

**定理**: 在p-adic拓扑中，每个点都是球的中心！

**直觉解释**:
想象你在一个球里移动，无论你走到哪里，看到的"球内景象"都是一样的。

这与欧几里得几何完全不同：
- 欧几里得球: 有唯一的中心
- p-adic球: 处处是中心

### 5.3 与数论的联系

**局部-整体原理** (Hasse原理):

问题在 $\mathbb{Q}$ 中有解 ⟺ 在所有 $\mathbb{Q}_p$ 和 $\mathbb{R}$ 中有解

**例子**: $x^2 - 2y^2 = -1$

- 在 $\mathbb{R}$ 中有解: $x=1, y=1$ ✓
- 在 $\mathbb{Q}_2$ 中: 需要检验
- 在 $\mathbb{Q}_p$ (p>2) 中: 通常有解

---

## 6. 遇到的问题与解决

### 问题1: 精度丢失

**现象**: 多次运算后结果变得不可靠。

**原因**: p-adic运算可能增加赋值，降低有效精度。

**解决**: 
1. 设置更高的初始精度
2. 定期检查结果的合理性
3. 使用库函数的精度参数

### 问题2: p=2的特殊性

**现象**: 某些公式对 $p=2$ 不成立。

**例子**: 二次剩余理论、收敛半径公式。

**解决**: 单独处理 $p=2$ 的情况，或使用更一般的公式。

### 问题3: 级数不收敛

**现象**: exp(5) 在 ℚ₅ 中计算失败。

**原因**: $|5|_5 = 1/5$，而收敛要求 $|x|_5 < 5^{-1/4} \approx 0.67$。

虽然 $0.2 < 0.67$，但数值计算可能不稳定。

**解决**: 使用更小的参数，如 exp(25)。

### 问题4: 概念混淆

**现象**: 分不清 "赋值" 和 "绝对值"。

**记忆技巧**:
- 赋值 $v_p$: 整数的，越大表示被 $p$ 整除越多
- 绝对值 $|x|_p$: 非负实数，越小表示越"接近"0

关系: $|x|_p = p^{-v_p(x)}$

---

## 7. 与后续学习的联系

### 7.1 p-adic模形式

**目标**: 理解p-adic模形式的理论。

**基础要求**:
- ✓ p-adic数的基本运算
- ✓ Hensel引理
- ⬜ p-adic L-函数
- ⬜ 过收敛模形式

### 7.2 自守形式

**联系**: p-adic自守表示使用p-adic分析工具。

**需要补充**:
- Bruhat-Tits树
- p-adic对称空间
- 刚性解析几何

### 7.3 物理应用

**量子混沌**: 某些量子混沌模型使用p-adic分析。

**AdS/CFT**: p-adic AdS/CFT对应是一个活跃的研究方向。

---

## 8. 关键公式速查

### 基本定义
$$v_p(p^n \cdot \frac{a}{b}) = n, \quad p \nmid a, p \nmid b$$

$$|x|_p = p^{-v_p(x)}$$

### 强三角不等式
$$|x + y|_p \leq \max(|x|_p, |y|_p)$$

等号成立当 $|x|_p \neq |y|_p$

### Hensel引理
若 $f(a_0) \equiv 0 \pmod{p}$ 且 $f'(a_0) \not\equiv 0 \pmod{p}$，则存在唯一的 $p$-adic根。

### 单位群结构
$$\mathbb{Z}_p^\times \cong \mu_{p-1} \times (1 + p\mathbb{Z}_p)$$

### 级数收敛
- $\exp(x)$: $|x|_p < p^{-1/(p-1)}$
- $\log(1+x)$: $|x|_p < 1$

---

## 9. 待深入研究的问题

1. **p-adic测度理论**: 如何定义p-adic积分？

2. **刚性解析几何**: Tate的刚性解析空间理论。

3. **p-adic霍奇理论**: 比较不同上同调理论。

4. **完美胚空间**: Scholze的新理论。

5. **p-adic朗兰兹纲领**: 当代数学的前沿。

---

## 10. 学习资源整理

### 已阅读
- [x] padic库的文档和示例
- [x] 本文档中的练习题

### 计划阅读
- [ ] Gouvêa "p-adic Numbers: An Introduction" (第1-3章)
- [ ] Koblitz "p-adic Analysis" (第1-2章)
- [ ] Serre "Local Fields" (选读)

### 在线资源
- [x] SageMath p-adic教程
- [ ] MathOverflow相关讨论
- [ ] nLab上的p-adic数条目

---

## 11. 下一步行动计划

1. **短期** (本周):
   - [ ] 完成所有练习代码的运行和验证
   - [ ] 整理常见错误和解决方案

2. **中期** (本月):
   - [ ] 学习p-adic L-函数基础
   - [ ] 阅读一篇p-adic模形式的综述文章

3. **长期** (本季度):
   - [ ] 理解经典模形式的p-adic理论
   - [ ] 探索与量子混沌的联系

---

**笔记最后更新**: 2026-02-11

**状态**: 基础计算练习完成，准备进入理论学习阶段
